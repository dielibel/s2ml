Bootstrap: docker
From: ubuntu:18.04 

%post
    apt-get -y update && apt-get install -y git
    apt-get update && apt-get install -y software-properties-common gcc
    add-apt-repository -y ppa:deadsnakes/ppa
    apt-get update && apt-get install -y python3.7 python3-distutils python3-pip python3-apt

    git clone https://github.com/openai/CLIP
    git clone https://github.com/crowsonkb/guided-diffusion
    pip3 install -e ./CLIP
    pip3 install -e ./guided-diffusion

    git clone https://github.com/CompVis/taming-transformers
    pip3 install ftfy regex tqdm omegaconf pytorch-lightning
    pip3 install kornia
    pip3 install einops
    pip3 install transformers
     
    pip3 install stegano
    apt install exempi
    pip3 install python-xmp-toolkit
    pip3 install imgtag
    pip3 install pillow==7.1.2
    pip3 install taming-transformers
                                
    git clone https://github.com/xinntao/ESRGAN

    pip3 install imageio-ffmpeg

    pip3 freeze > requirements.txt

%runscript
    echo "$*"

